{#
/**
 * Theme override for language switcher links.
 * Suggested filename: links--language-block.html.twig
 */
#}

{% if links %}
  {# ç”Ÿæˆä¸€ä¸ªç¨³å®š idï¼Œé¿å…å¤šä¸ªè¯­è¨€ block å†²çª #}
  {% set dd_id = 'lang-dd-' ~ attributes.id|default('main')|clean_id %}

  {# å½“å‰è¯­è¨€ï¼šæ¥è‡ª preprocess æ³¨å…¥ï¼Œ100% ç¨³ #}
  {% set lang_id = current_langcode|default('en') %}

  {# æŒ‰é’®æ˜¾ç¤ºçŸ­å #}
  {% if lang_id == 'zh-hans' %}
    {% set current_label = 'ğŸ‡¨ğŸ‡³ ä¸­æ–‡' %}
  {% elseif lang_id == 'en' %}
    {% set current_label = 'ğŸ‡ºğŸ‡¸ EN' %}
  {% else %}
    {% set current_label = lang_id|upper %}
  {% endif %}

  <div class="dropdown language-switcher-dropdown">
    <button
      class="btn btn-outline-secondary btn-sm dropdown-toggle"
      type="button"
      id="{{ dd_id }}"
      data-bs-toggle="dropdown"
      aria-expanded="false"
    >
      {{ current_label }}
    </button>

    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="{{ dd_id }}">
      {% for key, item in links %}
        {# ä¸‹æ‹‰æ˜¾ç¤ºçŸ­æ ‡ç­¾ #}
        {% set short_label = item.text|default(key) %}
        {% if key == 'zh-hans' %}
          {% set short_label = 'ğŸ‡¨ğŸ‡³ ä¸­æ–‡' %}
        {% elseif key == 'en' %}
          {% set short_label = 'ğŸ‡ºğŸ‡¸ EN' %}
        {% endif %}

        {% set is_current = (key == lang_id) %}

        <li>
          {% if item.link is defined %}
            {# ç”¨ Drupal ç»™çš„ linkï¼Œæœ€å°ä¿®æ”¹ classï¼ˆåŠ  dropdown-item/activeï¼‰ #}
            {% set link_html = item.link|render %}

            {# ç»™ <a> åŠ  dropdown-item #}
            {% if 'class="' in link_html %}
              {% set link_html = link_html|replace({'class="': 'class="dropdown-item '}) %}
            {% else %}
              {% set link_html = link_html|replace({'<a ': '<a class="dropdown-item" '}) %}
            {% endif %}

            {# å½“å‰è¯­è¨€é«˜äº® #}
            {% if is_current %}
              {% set link_html = link_html|replace({'dropdown-item ': 'dropdown-item active '}) %}
            {% endif %}

            {# æ›¿æ¢å¯è§æ–‡å­—ä¸ºçŸ­æ ‡ç­¾ï¼ˆåªå¤„ç†å¸¸è§é»˜è®¤è¯­è¨€åï¼‰ #}
            {% if key == 'zh-hans' %}
              {% set link_html = link_html|replace({'Chinese, Simplified': 'ğŸ‡¨ğŸ‡³ ä¸­æ–‡'}) %}
              {% set link_html = link_html|replace({'ä¸­æ–‡ï¼ˆç®€ä½“ï¼‰': 'ğŸ‡¨ğŸ‡³ ä¸­æ–‡'}) %}
            {% elseif key == 'en' %}
              {% set link_html = link_html|replace({'English': 'ğŸ‡ºğŸ‡¸ EN'}) %}
            {% endif %}

            {{ link_html|raw }}
          {% else %}
            <span class="dropdown-item{{ is_current ? ' active' : '' }}">{{ short_label }}</span>
          {% endif %}
        </li>
      {% endfor %}
    </ul>
  </div>
{% endif %}
